name: Daily - test install aio-cli

on:
  push:
    branches: [ master ]

jobs:
  build:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        node: [14]
        os: [ubuntu-latest]

    steps:
    - name: Setup CLI
      uses: adobe/aio-cli-setup-action@1.0.1
      with:
        os: ${{ matrix.os }}
    - name: npmaudit
      run: |
        mkdir testapp
        cd testapp
        aio app init -y
    - uses: oke-py/npm-audit-action@v1.7.2
      with:
        issue_title: 'High and/or Critical vulnerability found in npm audit'
        working_directory: './testapp'
        audit_level: high
        github_token: ${{ secrets.GITHUB_TOKEN }}
        dedupe_issues: true
